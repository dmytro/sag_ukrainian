%--------------------------------------------------------------------
\chapter{Завантаження та вимкнення системи}
\label{ch:boothalt}
%--------------------------------------------------------------------

        \begin{verse}\it
Start me up \\
Ah\dots you've got to\dots you've got to \\
Never, never never stop \\
Start it up \\
Ah\dots start it up, never, never, never \\
\ You make a grown man cry, \\
\ \ you make a grown man cry \\
(Rolling Stones) \\
% \ \\
% These boots are made for walking, \\
% and that's what they're gonna do. \\
% One of these days, these boots \\
% are gonna walk all over you. \\
        \rm\end{verse}
\index{Windows 95|see{crying}}
\index{crying}

        \noindent

	Цей розд╕л поясню╓, що в╕дбува╓ться тод╕, коли система з
	Л╕наксом вмика╓ться та вимика╓ться ╕ те, як вмикати та
	вимикати Л╕накс за правилами. Якщо не робити цього так, як
	потр╕бно, то можна пошкодити чи нав╕ть загубити файли.

\section{Огляд процес╕в старту та вимкнення}

	Д╕я вмикнення комп'ютера та завантаження його операц╕йно╖
	системи\footnote{На ранн╕х комп'ютерах було занадто мало
	просто вмикнути комп'ютер, Ви повинн╕ були б ще вручну
	виконати певн╕ д╕╖ для того, щоб операц╕йна система
	завантажилась в пам'ять. Ц╕ нов╕ сучасн╕ цяцьки вм╕ють робити
	це вже сам╕.} називають \defin{завантаженням}\intnote{booting,
	Досл╕вний переклад цього терм╕ну означа╓ щось н╕би "<взування
	чоб╕т">. Подальш╕ пояснення в цьому абзац╕ трактують саме цю
	назву.}. Назва походить в╕д образу, коли комп'ютер витягу╓ сам
	себе з болота за мотузки на чоботах, але процес сам по соб╕ трохи б╕льш
	реал╕стичний. 
\index{завантаження}
\index{booting}
\index{starting a computer}
\index{вмикнення комп'ютера}

	Стартуючи, на самому початку, комп'ютер чита╓ невеликий
	шматочок комп'ютерного коду, який носить назву
	\defin{початковий завантажувач}\intnote{bootstrap loader}, який в
	свою чергу вантажить та старту╓ операц╕йну систему. Початковий
	завантажувач найчаст╕ше запису╓ться в певному м╕сц╕ жорсткого
	диску чи дискети. Причина такого двоступеневого процесу старту
	операц╕йно╖ системи поляга╓ в тому, що операц╕йна система
	велика ╕ складна, а той початковий код, який чита╓ з диску
	комп'ютер, повинен бути дуже малим - всього к╕лька сотень байт
	- для того, щоб не приводити до зайвого ускладнення
	програмного забезпечення, вбудованого "<в зал╕з╕"> комп'ютера.

\index{початковий завантажувач}
\index{bootstrap loader}

	Р╕зн╕ комп'ютери виконоють початкове завантаження по р╕зному. У
	св╕т╕ PC комп'ютер (або точн╕ше його BIOS) чита╓ перший сектор
	(що називають \defin{завантажувальним сектором}) з гнучкого або
	жорсткого диску. Початковий   завантажувач ╓ частиною цього
	сектора. В╕н чита╓ та вантажить операц╕йну систему з ╕ншого
	м╕сця на диску (або з якогось ╕ншого м╕сця).

\index{завантажувальний сектор, boot sector}

	Коли Л╕накс (ядро) прочитано в пам'ять, в╕н проводить
	╕н╕ц╕ал╕зац╕ю апаратного забезпечення ╕ п╕сля цього запуска╓
	\cmd{init}. \cmd{init} старту╓ ╕нш╕ процеси та дозволя╓
	користувачам ре╓струватися в систем╕ та виконувати свою
	роботу. Подробиц╕ цього процесу розглядатимуться дал╕. 
	
	При вимкненн╕ системи вс╕м процесам пов╕домля╓ться, що вони
	повинн╕ зак╕нчити свою роботу (це змушу╓ ╖х закрити вс╕
	в╕дкрит╕ на даний час файли та виконати ╕нш╕ под╕бного роду
	д╕╖), п╕сля цього в╕дмонтовуються файлов╕ системи та област╕
	своп╕н╜у, ╕ врешт╕-решт, на екран╕ друку╓ться пов╕домлення про
	те, що можна вимкнути напругу. Якщо ця процедура не виконана
	як сл╕д, можуть трапитися непри╓м╕ реч╕, а саме: може
	виявитися, що буферний кеш файлово╖ системи не злито на
	диск. Це означа╓, що вс╕ дан╕, як╕ перебували в буфер╕
	загублено ╕, що файлова система пошкоджена, або ╕нколи нав╕ть,
	що нею не можна користуватися.

\index{дисковий кеш, buffer cache}
\index{втрати даних, data loss}

\section{Старт системи зблизька}
\label{sec:boot-closeup}

	Л╕накс можна завантажити або ╕з гнучкого, або ╕з жорсткого
	диску\begin{intnote}
%
	З доданням деяких др╕бничок PC можна зробити бездисковим
	кл╕╓нтом - тобто комп'ютером, в якому нема╓ н╕ гнучких н╕
	жорстких диск╕в, ╕ який можна грузити з сервера в
	мереж╕. Справжня знах╕дка для обчислювальних зал╕в на багато
	користувач╕в чи для навчальних клас╕в в школах чи
	ун╕верситетах. Для робочих станц╕й Sun Sparc не треба н╕чого
	додавати взагал╕ - кожен Sparc - це готовий бездисковий
	кл╕╓нт, який буде грузитися зв╕дти, зв╕дки скаже
	адм╕н╕стратор. Теж саме - нов╕ модел╕ Macintosh'╕в, як╕
	побудован╕ з п╕дтримкою завантаження з мереж╕ (╕ для яких, до
	реч╕, теж ╕сну╓ верс╕я Л╕накса).

	\end{intnote}. Розд╕л "<Установка"> в Пос╕бнику по установц╕ та перших
	кроках в Л╕накс╕ \intnote{ Installation and Getting Started
	guide (\cite{getting-started}) } розкаже Вам, як зробити так,
	щоб Л╕накс грузився або зв╕дти, або зв╕дти.

	П╕д час початкового старту комп'ютера BIOS викону╓
	р╕зноман╕тн╕ тести, перев╕ряючи, що з апаратурою все в
	порядку,\footnote{це назива╓ться \defin{power on self
	test}\intnote{автоматичний тест при вмикненн╕ живлення}
	або POST\intnote{ми будемо притримуватися дано╖ абрев╕атури в
	нашому переклад╕ (як м╕н╕мум до того часу, поки хто-небудь не
	запропону╓ кращо╖}} ╕ п╕сля цього почина╓ справжн╓
	завантаження. В╕н вибере дисковий пристр╕й (в б╕льшост╕ випадк╕в -
	перший дисков╕д, якщо в нього вставлена дискета, якщо ж н╕ -
	то перший жорсткий диск, якщо такий встановлено в
	комп'ютер╕. ╤нколи порядок пошуку може зм╕нюватися.) ╕
	прочита╓ самий перший сектор цього диску. Цей сектор називають
	\defin{завантажувальним сектором}\intnote{boot sector}, у
	в╕дношенн╕ до жорстких диск╕в цей сектор назива╓ться також
	\defin{головним завантажувальним сектором}\intnote{main boot
	record}, оск╕льки на диску може бути к╕лька розд╕л╕в, ╕ кожен
	╕з розд╕л╕в ма╓ св╕й власний завантажувальний сектор. 

\index{BIOS}
\index{головний завантажувальний сектор, master boot record}
\index{MBR}
\index{завантажувальний сектор розд╕лу, partition boot record}
\index{завантажувальний запис, boot record!master|see{MBR}}
\index{boot record!partition|see{partition boot record}}

	Завантажувальний сектор м╕стить невелику програмку (малу наст╕льки,
	що вона може пом╕ститися в один сектор). В╕дпов╕дальн╕стю ц╕╓╖
	програмки ╓: прочитати операц╕йну систему з диску та
	стартувати ╖╖. При завантаженн╕ Л╕накса з дискети, в завантажувальному
	сектор╕ записана програма, яка просто-напросто чита╓ к╕лька
	сотень перших блок╕в (в залежност╕ в╕д справжнього розм╕ру
	ядра) в попередньо визначену д╕лянку пам'ят╕. Дуже часто на
	завантажувальн╕й дискет╕ файлово╖ системи нема╓. Ядро просто
	запису╓ться в посл╕довност╕ сектор╕в. Це значно полегшу╓
	процес старту системи. Однак, можливо також вантажити Л╕накс з
	дискети з файловою системою, користуючись LILO (the LInux
	LOader)\intnote{завантажувач Л╕накса}. \intnote{В св╕т╕ Л╕накса
	для Sparc та для Alfa процесор╕в назва LILO трансформу╓ться в
	SILO та MILO в╕дпов╕дно}
	
\index{завантаження з дискети, booting!from floppy}
\index{дискета!завантаження з, floppy!booting from|див{завантаження}}

	При завантаженн╕ з жорсткого диску, код (програма) в головному
	завантажувальному сектор╕ анал╕зу╓ таблицю розд╕л╕в диску (яка
	також знаходиться в головному завантажувальному блоц╕) ╕
	знаходить активний п╕дрозд╕л. Для того, щоб було зрозум╕ло, що
	з такого розд╕лу можна грузитися, в╕н познача╓ться спец╕альним
	прапорцем - б╕том. П╕сля цього код завантажувача з MBR чита╓
	завантажувальний сектор активного розд╕лу ╕ переда╓ на нього
	керування процесору. Код в завантажувальному сектор╕ активного
	розд╕лу робить те ж саме, що ╕ код в завантажувальному сектор╕
	дискети: чита╓ ядро з диску та запуска╓ його на
	виконання. Звичайно ж, подробиц╕ старту в╕др╕зняються. Не ма╓
	н╕якого сенсу тримати на диску окремий розд╕л т╕льки для того,
	щоб тримати на ньому ядро. Тож, завантажувальний код в
	завантажувальному сектор╕ диску не може просто читати все
	п╕дряд з посл╕довност╕ сектор╕в. В╕н повинен спершу визначити
	де операц╕йна система розм╕стила ядро на диску. ╢ к╕лька
	р╕зних шлях╕в вир╕шення питання пошуку ядра на диску, але
	найб╕льш вживаний - це застосування LILO. (Подробиц╕ того, як
	саме це зробити, виходять за меж╕ тематики ц╕╓╖ дискус╕╖, отож
	див╕ться документац╕ю по LILO, щоб зрозум╕ти ц╕ процеси
	краще.)

\index{завантаження!з жорсткого диску}
\index{жорсткий диск!завантаження|див. {завантаження}}
\index{таблиця п╕дрозд╕л╕в}
\index{активний п╕дрозд╕л}
\index{LILO}

	При завантаженн╕ комп'ютера з LILO, як правило, в╕н старту╓ Ваше
	"<основне">("<робоче">) ядро. LILO можна сконф╕╜урувати так,
	що в╕н буде завантажувати ╕нш╕ ядра, або нав╕ть одну з к╕лькох
	оперативних систем. Кр╕м того, LILO да╓ користувачев╕ виб╕р
	того, яке ядро чи яку систему стартувати при дан╕й
	завантаженн╕. LILO можна настро╖ти так, що при натисканн╕ клав╕ш
	{\tt alt}, {\tt shift}, чи {\tt ctrl} п╕д час завантаження, в╕н
	зупиниться, утрима╓ться в╕д стандартного завантаження ╕ спита╓ яку
	систему завантажити. Також LILO можна настро╖ти таким чином, що
	в╕н завжди буде зупинятися при завантаженн╕ на  певний час
	щоб спитати, яку систему грузити. Якщо LILO не отрима╓
	в╕дпов╕д╕ на протяз╕ цього часу, то завантажить основне ядро.

	При використанн╕ LILO ядру системи також можна передавати 
	параметри з командного рядка. 
	

	\meta ╤снують також ╕нш╕ завантажувач╕ окр╕м LILO. ╤нформац╕я про
	них буде додана п╕зн╕ше, в наступних верс╕ях. loadlin.

	Як завантаження з дискети, так ╕ завантаження з жорсткого диску мають
	як сво╖ плюси, так ╕ м╕нуси. Але загалом завантаження з жорсткого
	диску вигляда╓ набагато краще, оск╕льки можна позбутися цих
	дискет, як╕ будуть тягатися скр╕зь ╕ всюди. Кр╕м того - це
	швидше. Однак, ╕нколи можливо трохи важче встановити систему
	так, щоб вона завантажувалась з жорсткого диску. Тому багато хто
	спочатку завантажують систему з дискети. П╕сля того, як система
	в основному встановлена ╕ сконф╕╜урована, встановлюють LILO ╕
	починають грузитися з жорского диску.

	Коли ядро системи вже прочитане в пам'ять системи,
	в╕дбува╓ться приблизно таке:


    \begin{itemize}

    \item

	Ядро Л╕накса запису╓ться на диск стисненим
	(заарх╕вованим). Отже воно ма╓ бути розарх╕вованим
	спочатку. Початок ядра м╕стить невеличку програмку, яка
	викону╓ цю операц╕ю\intnote{Це в╕дноситься т╕льки до Л╕накса
	i86, тобто для IBM-сум╕сних PC, ╕ не стосу╓ться ╕нших
	Л╕накс╕в, таких як Sparc, Alfa, PowerPC, тощо, бо ц╕ процесори
	не мають ╕снуючо╖ в св╕т╕ PC меж╕ на 640 кбайт пам'ят╕.}.

\index{стисканна ядра}

    \item

	Якщо Ваша система ма╓ в╕деоплату типу cупер-VGA, то Л╕накс
	зможе це розп╕знати.  Тод╕ Л╕накс дасть можлив╕сть
	скористуватися спец╕альними текстовими режимами, такими, як,
	наприклад, 100 стовпчик╕в по 40 рядк╕в. В╕део режим екрану
	можна встановити п╕д час комп╕ляц╕╖ ядра. Тод╕ п╕д час старту
	ядро не буде задавати зайвих запитань. Кр╕м того цього ж можна
	добитися за допомогою LILO або \cmd{rdev}.

\index{в╕део плата}
\index{конф╕╜урац╕я ядра}
\index{в╕део режими}
\index{текстовий режим}

    \item

	П╕сля цього ядро почина╓ перев╕ряти яке обладнання ма╓
	комп'ютер (жорстк╕ диски, приводи дискет, плати мереж╕\ldots),
	та конф╕╜уру╓ деяк╕ з драйвер╕в знайдених пристро╖в
	в╕дпов╕дно. П╕д час цього на екран виводяться пов╕домлення про
	знах╕дки ядра. Наприклад, п╕д час завантаження на сво╓му екран╕ я
	бачу: 
\index{конф╕╜урац╕я обладнання}
\index{конф╕╜урац╕я драйвер╕в пристро╖в}
\index{пов╕дмлення системи при старт╕}
\index{завантаження!пов╕домлення}
%%%%%%%%
		\begin{quote}\begin{verbatim}
LILO boot:
Loading linux.
Console: colour EGA+ 80x25, 8 virtual consoles
Serial driver version 3.94 with no serial options enabled
tty00 at 0x03f8 (irq = 4) is a 16450
tty01 at 0x02f8 (irq = 3) is a 16450
lp_init: lp1 exists (0), using polling driver
Memory: 7332k/8192k available (300k kernel code, 384k reserved, 176k data)
Floppy drive(s): fd0 is 1.44M, fd1 is 1.2M
Loopback device init
Warning WD8013 board not found at i/o = 280.
Math coprocessor using irq13 error reporting.
Partition check:
  hda: hda1 hda2 hda3
VFS: Mounted root (ext filesystem).
Linux version 0.99.pl9-1 (root@haven) 05/01/93 14:12:20
		\end{verbatim}\end{quote}
%%%%%%%%

	Пов╕домлення на Вашому екран╕ будуть ╕ншими. Вони залежать в╕д
	обладнання, встановленого в систем╕, в╕д верс╕╖ Л╕накса та в╕д
	конф╕╜урац╕╖ системи.

   \item

	П╕сля цього ядро робить спробу змонтувати кореневу файлову
	систему. М╕сцезнаходження ╖╖ зада╓ться п╕д час комп╕лювання
	ядра, командою \cmd{rdev} чи за допомогою LILO.  Тип файлово╖
	системи визнача╓ться автоматично. Якщо ядро не може змонтувати
	кореневу файлову систему (наприклад, з то╖ причини, що Ви
	забули включити драйвер дано╖ системи в ядро п╕д час його
	комп╕ляц╕╖), ядро пан╕ку╓ ╕ зупиня╓ систему (все одно йому
	нема чого робити).
\index{коренева файлова система}
\index{файлов╕ системи!коренева}
\index{монтування!коренева файлова система}
\index{LILO}
\index{пан╕ка ядра}
\index{пан╕ка}

	Звичайно коренева файлова система монту╓ться в режими т╕льки
	читання  (це встановлю╓ться так само, як ╕ ╖╖ м╕сце). Це да╓
	можлив╕сть перев╕ряти файлову систему п╕д час монтування, бо
	не дуже гарно перев╕ряти файлову систему тод╕, коли вона
	змонтована на запис. 

\index{коренева файлова система т╕льки на читання}
\index{перев╕рка файлово╖ системи}
\index{fsck}

    \item

	П╕сля цього ядро старту╓ програму \cmd{init}, яка знаходиться
	в \fn{/sbin/init}. \cmd{init} запуска╓ться в фоновому
	режим╕\begin{intnote}
%
	В традиц╕йних Юн╕ксах самим першим процесом ╓ завжди процес з
	номером 0 - swapper. Цей процес старту╓ (народжу╓) один ╓диний
	процес - процес init, який (як це не дивно) отриму╓ номер
	1. Вс╕ ╕нш╕ процеси кр╕м цих двох можуть народжуватися ╕
	вмирати поки працю╓ процесор, отримують р╕зн╕ номери, але
	процеси 0 ╕ 1 живуть поки жива система ╕ вмирають разом з
	нею. init - багатод╕тний батько вс╕х ╕нших процес╕в системи.

	\end{intnote} ╕ завжди отриму╓ номер 1. \cmd{init} викону╓ р╕зн╕ стартов╕
	функц╕╖. Що саме в╕н робить залежить в╕д його конф╕╜урац╕╖,
	див╕ться розд╕л~\ref{ch:init} (не написаний поки що). Як
	м╕н╕мум в╕н старту╓ деяк╕ важлив╕ демони.

\index{демони!старт}

    \item

	П╕сля цього \cmd{init} переходить в багато користувацький
	режим ╕ старту╓ \cmd{getty} для в╕ртуальних консол╕в та
	посл╕довних порт╕в. Команда \cmd{getty} - це програма, яка
	дозволя╓ користувачам ре╓струватися в систем╕, використовуючи
	при цьому в╕ртуальн╕ консол╕ або посл╕довн╕ порти. В
	залежност╕ в╕д того, як в╕н сконф╕╜ураваний \cmd{init} може
	стартувати також ╕нш╕ програми.

\index{в╕ртуальн╕ консол╕}
\index{консоль}
\index{терм╕нал}
\index{посл╕довний терм╕нал}

    \item

	П╕сля цього вже завантаження системи зак╕нчена ╕ система працю╓ в
	сво╓му нормальному режим╕. 

    \end{itemize}

\section{Трохи б╕льше про вимкнення}


	Важливою ╓ процедура вимикання системи. П╕сля нев╕рного
	вимкнення Ваша файлова система може в╕дправитися в см╕тник або
	будете мати попсован╕ файли. Це в╕дбува╓ться тому, що Л╕накс
	запису╓ дан╕ на диск не в╕дразу, а через певний ╕нтервал ╕ в╕н
	не зможе записати дисковий кеш на диск при раптовому
	вимененн╕. Дисковий кеш значно п╕двищу╓ швидк╕сть роботи, але
	також п╕двищу╓ ймов╕рн╕сть помилок при нев╕рному вимкненн╕
	живлення.

\index{вимкнення}
\index{буферний кеш}
\index{кеш}
\index{дисковий кеш}

	╤ншим аргументом проти раптового вимкнення напруги, може бути
	те, що в багатозадачн╕й систем╕ може бути безл╕ч процес╕в, як╕
	в╕дбуваються одночасно в фоновому режим╕, ╕ вимкнення напруги
	може бути катастрофою. Виконуючи визначену посл╕довн╕сть при
	вимкненн╕ системи Ви також забезпечу╓те в╕рн╕сть вимкнення
	вс╕х фонових задач. 

\index{фонов╕ процеси!та вимкнення}

	Команда для вимикання системи в Л╕накс╕ - \cmd{shutdown}. Нею
	можна користуватися одним ╕з двох способ╕в. 

\index{shutdown!використання}

	В систем╕, де Ви - ╓диний користувач, користуйтеся командою
	наступним чином. Вимкн╕ть вс╕ працююч╕ програми, вийд╕ть з
	ус╕х робочих сес╕й (з ус╕х в╕ртуальних консол╕в),
	заре╓струйтеся в систем╕ як \texttt{root} на одн╕й з консолей
	(або залиш╕ться на одн╕й консол╕, якщо Ви працювали як
	\texttt{root}, але при цьому краще перейти в кореневу
	директор╕ю, щоб позбутися проблем з в╕дмонтуванням файлових
	систем). П╕сля цього виконайте команду
	\texttt{shutdown~-h~now} \index{shutdown,вимкнення}. Якщо Ви
	хочете вимкнути систему з затримкою, зам╕н╕ть текст
	\texttt{now} знаком плюс за яким ╕де к╕льк╕сть хвилин
	затримки. Хоча в систем╕ з одним користувачем це навряд чи
	потр╕бно.

	Якщо ж Ваша система використову╓ться багатьма користувачами,
	використовуйте команду \texttt{shutdown~-h~\textsl{+час
	пов╕домлення}}, де \textsl{час} - це час в хвилинах до зупинки
	системи, а \textsl{пов╕домлення} - це коротке пояснення причини
	зупинки системи. 
		%
\begin{quote}\tt
\# shutdown -h +10 'We will install a new disk.  System should \\
> be back on-line in three hours.' \\
\#
\rm\end{quote}
		%
	Це пов╕домлення попередить вс╕х, хто користу╓ться системою, що
	система вимика╓ться через десять хвилин. ╤ користувачам краще
	б вийти з системи, якщо вони не хочуть загубити сво╖
	дан╕. Пов╕домлення друку╓ться на кожному терм╕нал╕, на якому
	хто-небудь заре╓струвався в систем╕, включаючи \cmd{xterm}'и.
		%
\begin{quote}\tt
Broadcast message from root (ttyp0) Wed Aug  2 01:03:25 1995... \\
\ \\
We will install a new disk.  System should \\
be back on-line in three hours. \\
The system is going DOWN for system halt in 10 minutes !!
\rm\end{quote}
		%
	Пов╕домлення повторю╓ться автоматично к╕лька раз╕в перед тим,
	як система вимкнеться з все коротшими ╕ коротшими пром╕жками
	м╕ж посл╕довними попередженнями.
\index{пов╕домлення про вимкнення}

	Пот╕м почина╓ться справжн╓ вимкнення системи. В╕дмонтовуються
	вс╕ файлов╕ системи за винятком коренево╖, вбиваються вс╕
	процеси користувач╕в (якщо все ще хто-небудь залиша╓ться в
	систем╕), вимикаються демони, в╕дмонтовуються вс╕ файлов╕
	системи, ╕ зупиня╓ться все взагал╕. Коли все це зроблено,
	\cmd{init} друку╓ на екран╕ пов╕домлення про те, що Ви можете
	вимкнути машину. Тод╕, {\em ╕ т╕льки тод╕}, можете простягати
	сво╖ руки до вимикача живлення.

\index{вимкнення!посл╕довн╕сть}

	╤нколи, хоча на стаб╕льн╕й систем╕ дуже р╕дко, неможливо в╕рно
	вимкнути систему. Наприклад, якщо ядро пан╕ку╓ ╕ поводить себе
	дивно, неможливо подати йому будь-яку команду. Тож вимкнути
	систему в╕рно дещо проблематично. ╤ практично ╓дине, що Вам
	залиша╓ться, це спод╕ватися, що н╕чого поки-що не з╕псовано ╕
	вимкнути напругу. Якщо Ваш╕ проблеми з системою трохи менш╕,
	н╕ж описан╕ т╕льки що (наприклад, хтось с╕в на клав╕атуру), ╕
	як ядро так ╕ демон \cmd{update} все ще працюють, тод╕ варто
	зачекати к╕лька хвилин, щоб \cmd{update} м╕г записати вс╕
	буфери на диск ╕ вимкнути напругу вже п╕сля цього.

\index{крах}
\index{крах системи}
\index{вимкнення!терм╕нове}
\index{нев╕рне вимкнення|див{вимкнення, терм╕нове}}
\index{буферний кеш}
\index{терм╕нове вимкнення|див{вимкнення, терм╕нове}}

	Дехто вимика╓ систему виконуючи команду
	\cmd{sync}\footnote{\cmd{sync} злива╓ на диск дисковий кеш}
	трич╕, чекають, поки зупиниться запис/читання з диску ╕
	вимикають напругу п╕сля цього\begin{intnote}Працююч╕ в
	SunOS/Solaris'╕ добавляють ще ╕ \cmd{halt} в к╕нц╕. \cmd{halt}
	зупиня╓ роботу процесора. Але в Л╕накс╕ \cmd{halt} робить те ж
	саме, що ╕ \cmd{shutdown~-h} - в╕дмотову╓ файлов╕ системи ╕
	т.п.\end{intnote}.  Якщо в систем╕ нема╓ працюючих програм, то це майже те
	ж саме, що ╕ користуватися \cmd{shutdown}. Але такий процес не
	в╕дмонтову╓ н╕яких файлових систем ╕ це може призвести до
	деяких проблем з прапорцем "<чистоти"> файлово╖ системи
	ext2. Отже, метод потр╕йного-sync'у \emph{ не рекоменду╓ться}.
\index{вимкнення!потр╕йний sync}

	(Якщо Вас це ц╕кавить: причина \emph{ потр╕йного} sync'у в
	тому, що на початку ╕стор╕╖ Юн╕кса це давало досить часу, щоб
	зак╕нчилися вс╕ операц╕╖ вводу/виводу.)

\section{Перевантаження}

	Перевантаження означа╓ повторне завантаження системи. Це можна зробити
	спершу вимкнувши систему повн╕стю, вимкнувши напругу ╕ пот╕м
	вмикнувши ╖╖ знову. Прост╕ший спос╕б - це сказати команд╕
	\cmd{shutdown}, перегрузити систему зам╕сть того, щоб вимикати
	систему повн╕стю. Для цього ╖й треба вказати параметр
	\texttt{-r}, тобто виконати таку команду \texttt{shutdown -r
	now}. 
\index{перегрузка}
	
	Б╕льш╕сть Л╕накс╕в сконф╕╜урован╕ таким чином, що при
	натисканн╕ на клав╕атур╕ трьох клав╕ш ctrl-alt-del викону╓ться
	команда \texttt{shutdown -r now}. \intnote{Невелике уточнення
	- т╕льки при робот╕ у текстовому режим╕ на терм╕нал╕. В X
	Windows "<трьох-клав╕шний салют"> не робить н╕чого. X Windows
	перехоплю╓ сигнали в╕д клав╕атури ╕ тракту╓ ╖х по сво╓му.} Це
	призводить до перегрузки системи. Однак, це теж можна зм╕нити,
	╕ краще це зробити, щоб дати користувачам деякий час перед
	перегрузкою системи. Системи, до яких доступ в╕льний, можна
	настро╖ти так, щоб при натисканн╕ ctrl-alt-del н╕чого не
	в╕дбувалося.

\index{ctrl-alt-del}
\index{init!та ctrl-alt-del}

\section{Однокористувацький режим}

	Команда \cmd{shutdown} також може використовуватися для
	переводу системи в однокористувацький режим, тобто такий
	режим, в якому н╕хто не може заре╓струватися в систем╕ кр╕м
	користувача \texttt{root} з системно╖ консол╕. Цей режим
	використову╓ться системними адм╕н╕страторами для виконання тих
	операц╕й, як╕ неможливо виконати в звичайному
	режим╕. Однокористувацький режим з б╕льшими подробицями
	описано в розд╕л╕~\ref{chap:daemons}.
\index{однокористувацький режим}
\index{init!однокористувацький режим}

\section{Авар╕йн╕ завантажувальн╕ дискети}

	Не завжди комп'ютер може завантажитися з жорсткого
	диску. Наприклад, якщо Ви помилилися при конф╕╜урац╕╖ LILO,
	може статися так, що система не буде грузитися. Для таких
	ситуац╕й потр╕бно мати запасний спос╕б завантеження системи, який
	би працював завжди (як м╕н╕мум до тих п╕р, поки працю╓
	апаратура). Для типового PC це означа╓ завантеження з дискети.
\index{завантаження!з авар╕йно╖ дискети}
\index{прив╕д дисководу}

	Б╕льш╕сть Л╕накс╕в, що розповсюджуються на сьогодн╕,
	дозволяють створити \defin{авар╕йну завантажувальну дискету}. Варто
	створити ╖╖ як можна швидше. Однак, ╕нколи завантажувальн╕ дискети
	мають т╕льки ядро, передбачаючи, що Ви будете користуватися
	╕ншими програмами з придбаного комплекту для виправлення вс╕х
	Ваших негаразд╕в. Бува╓ так, що цих програм не
	досить. Наприклад, Вам потр╕бно в╕дновити к╕лька файл╕в з
	резервних коп╕й зроблених ран╕ше, а не з установочних диск╕в.
\index{резевн╕ коп╕╖}
\index{установочн╕ диски}
\index{авар╕йн╕ дискети!використання}

	Таким чином, може буде потр╕бно створити власн╕ авар╕йн╕
	дискети з кореневою файловою системою на них. ╤нформац╕ю про
	те, як це зробити, можна знайти в документ╕ написаному ╫рехам
	Чепменом \intnote{Graham Chapman} \emph{ Bootdisk HOWTO}
	(\cite{bootdisk-howto}). Звичайно, потр╕бно пот╕м п╕дтримувати
	сво╖ завантажувальну та кореневу дискету в порядку ╕ поновлювати ╖х
	при необх╕дност╕.
\index{авар╕йн╕ дискети!виготовлення}

	При авар╕йному завантаженн╕ дисков╕д, який використову╓ться для
	монтування коренево╖ файлово╖ системи, неможливо
	використовувати для ╕нших ц╕лей. Якщо система ма╓ всього один
	дисков╕д, це приносить велик╕ незручност╕. Однак, якщо в
	систем╕ досить пам'ят╕, завантажувальну дискету можна створити
	таким чином, що дискета з кореневою файловою системою
	прочита╓ться в пам'ять, ╕ в пам'ят╕ створиться в╕ртуальний
	диск \intnote{ramdisk}. Щоб це було можливо, ядро системи
	повинно бути настро╓не в╕дпов╕дним чином. П╕сля того, як
	коренева файлова система змонтована з в╕ртуального диску,
	дисков╕д може використовуватися для монтування ╕нших дискет.
\index{в╕ртуальний диск}
